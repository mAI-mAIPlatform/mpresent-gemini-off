<!DOCTYPE html>
<html lang="fr" style="scroll-behavior: smooth;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mAI - Explorer</title>
    <!-- Chargement de Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Configuration de la police Inter par défaut */
        :root {
            font-family: 'Inter', sans-serif;
        }

        /* Classe utilitaire personnalisée pour l'effet Glassmorphism/Liquid Glass */
        .glass-nav {
            background-color: rgba(31, 41, 55, 0.9); /* bg-gray-800 avec transparence */
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.15); 
        }
        
        /* Assure que l'ancre n'est pas cachée sous le header fixe lors du scroll */
        :target::before {
            content: "";
            display: block;
            height: 6rem; /* Correspond à la hauteur de la nav pour compenser */
            margin-top: -6rem; 
        }

        /* Styles pour le bouton de chargement */
        .loading-spinner {
            border-top-color: #3b82f6;
            border-left-color: #3b82f6;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">

    <!-- BARRE DE NAVIGATION (Liquid Glass) -->
    <nav class="fixed top-0 left-0 right-0 z-50 p-4 glass-nav">
        <div class="max-w-6xl mx-auto flex justify-start items-center">
            
            <!-- Logo mAI -->
            <a href="#" class="flex items-center space-x-2 transition duration-300 hover:opacity-80">
                <svg class="w-7 h-7 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1v-3.25m-7.25-10.5A6.75 6.75 0 0112 3a6.75 6.75 0 017.5 6.25c0 1.25-.5 2.5-1.5 3.5l-2 2h-8l-2-2c-1-1-1.5-2.25-1.5-3.5z"></path>
                </svg>
                <span class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-300 to-purple-300">mAI</span>
            </a>
            <!-- Ajout des liens d'ancrage -->
            <div class="ml-10 space-x-6 hidden sm:flex">
                <a href="#fonctionnalites" class="text-gray-300 hover:text-white transition duration-200 font-medium">Fonctionnalités</a>
                <a href="#modeles" class="text-gray-300 hover:text-white transition duration-200 font-medium">Modèles</a>
                <a href="#explorateur" class="text-gray-300 hover:text-white transition duration-200 font-medium">Explorateur</a>
                <a href="#temoignages" class="text-gray-300 hover:text-white transition duration-200 font-medium">Témoignages</a>
            </div>
        </div>
    </nav>

    <!-- CONTENU PRINCIPAL -->
    <main class="pt-24 pb-12 max-w-6xl mx-auto px-4">

        <!-- SECTION 1: PRÉSENTATION (HERO) -->
        <div class="flex flex-col items-center justify-center mb-24">
            <div class="w-full max-w-4xl bg-gray-800 rounded-3xl shadow-2xl p-8 md:p-12 text-center border-2 border-indigo-700/50">

                <!-- Icône et Titre -->
                <div class="mb-8">
                    <svg class="w-24 h-24 mx-auto text-indigo-400 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1v-3.25m-7.25-10.5A6.75 6.75 0 0112 3a6.75 6.75 0 017.5 6.25c0 1.25-.5 2.5-1.5 3.5l-2 2h-8l-2-2c-1-1-1.5-2.25-1.5-3.5z"></path>
                    </svg>
                    <h1 class="text-6xl font-extrabold mt-4 text-transparent bg-clip-text bg-gradient-to-r from-indigo-300 to-purple-400">
                        Avec mAI, passez à la vitesse supérieure !
                    </h1>
                    <p class="text-indigo-300 text-2xl mt-3 font-light">Le partenaire intelligent qui amplifie vos capacités.</p>
                </div>

                <!-- Texte de description -->
                <div class="space-y-4 text-center text-gray-300 max-w-2xl mx-auto">
                    <p class="text-lg">
                        mAI n'est pas qu'une simple IA. C'est un système modulaire conçu pour s'intégrer fluidement à votre flux de travail, offrant une <span class="text-white font-semibold">précision inégalée</span> et une <span class="text-white font-semibold">vitesse d'exécution exceptionnelle</span>.
                    </p>
                    <p class="text-sm italic text-gray-500 pt-4">
                        (Pour plus d'informations ou pour l'essayer, veuillez contacter l'équipe commerciale.)
                    </p>
                </div>
            </div>
        </div>

        <!-- SECTION 2: FONCTIONNALITÉS CLÉS (Emojis remplacés par SVG) -->
        <section id="fonctionnalites" class="py-16 md:py-24">
            <h2 class="text-4xl font-bold text-center mb-16 text-white">Ce qui rend mAI Unique</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                
                <!-- Fonctionnalité 1: Intégration (SVG) -->
                <div class="text-center p-6 rounded-xl bg-gray-800/60 hover:bg-gray-700/70 transition duration-300 shadow-xl border border-gray-700/50">
                    <div class="flex justify-center mb-4">
                        <!-- Icone de Lien (Link) -->
                        <svg class="w-12 h-12 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.142a4 4 0 005.656 0l4-4a4 4 0 10-5.656-5.656l-1.1 1.1"></path>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-semibold mb-3 text-white">Intégration Facile</h3>
                    <p class="text-gray-400">
                        Connectez mAI à vos outils et plateformes existants en quelques clics. Un co-pilote qui s'adapte à votre environnement de travail.
                    </p>
                </div>

                <!-- Fonctionnalité 2: Sécurité (SVG) -->
                <div class="text-center p-6 rounded-xl bg-gray-800/60 hover:bg-gray-700/70 transition duration-300 shadow-xl border border-gray-700/50">
                    <div class="flex justify-center mb-4">
                        <!-- Icone de Verrou (Lock Closed) -->
                        <svg class="w-12 h-12 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-semibold mb-3 text-white">Sécurité Maximale</h3>
                    <p class="text-gray-400">
                        Vos données sont chiffrées de bout en bout et traitées avec la plus haute confidentialité. Travaillez l'esprit tranquille.
                    </p>
                </div>

                <!-- Fonctionnalité 3: Évolution (SVG) -->
                <div class="text-center p-6 rounded-xl bg-gray-800/60 hover:bg-gray-700/70 transition duration-300 shadow-xl border border-gray-700/50">
                    <div class="flex justify-center mb-4">
                        <!-- Icone d'Étoile (Star) -->
                        <svg class="w-12 h-12 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.05-2.05a.86.86 0 011.2 0l4 4a.86.86 0 010 1.2L12 19.85l-7.2-7.2a.86.86 0 010-1.2l4-4a.86.86 0 011.2 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-semibold mb-3 text-white">Mises à jours régulières</h3>
                    <p class="text-gray-400">
                        Notre IA apprend et évolue chaque semaine pour vous fournir des performances toujours à la pointe de la technologie.
                    </p>
                </div>

            </div>
        </section>

        <!-- SECTION 3: MODÈLES (Logos d'images supprimés) -->
        <section id="modeles" class="py-16 md:py-24">
            <h2 class="text-4xl font-bold text-center mb-12 text-indigo-400">Nos 5 Modèles d'Intelligence Artificielle</h2>
            
            <!-- La grille s'adapte pour afficher 2, 3 ou 5 cartes selon la taille de l'écran -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6">
                
                <!-- Modèle 1: m-4.0 -->
                <div class="model-card bg-gray-800/70 p-5 rounded-xl shadow-lg border border-gray-700/50 hover:border-indigo-500 transition duration-300 transform hover:translate-y-[-4px]">
                    <h3 class="text-lg font-semibold mb-2 flex items-center text-white">
                        <span class="w-6 h-6 mr-2 bg-indigo-500 rounded-full flex-shrink-0"></span><!-- Icône de remplacement -->
                        m-4.0
                    </h3>
                    <p class="text-gray-400 text-sm line-clamp-3">
                        Pour les tâches quotidiennes, rapide.
                    </p>
                    <span class="mt-3 inline-block text-xs font-mono px-2 py-0.5 rounded-full bg-indigo-900 text-indigo-300">Quotidien</span>
                </div>

                <!-- Modèle 2: m-4.3-mini -->
                <div class="model-card bg-gray-800/70 p-5 rounded-xl shadow-lg border border-gray-700/50 hover:border-purple-500 transition duration-300 transform hover:translate-y-[-4px]">
                    <h3 class="text-lg font-semibold mb-2 flex items-center text-white">
                        <span class="w-6 h-6 mr-2 bg-purple-500 rounded-full flex-shrink-0"></span><!-- Icône de remplacement -->
                        m-4.3-mini
                    </h3>
                    <p class="text-gray-400 text-sm line-clamp-3">
                        Écologique, court.
                    </p>
                    <span class="mt-3 inline-block text-xs font-mono px-2 py-0.5 rounded-full bg-purple-900 text-purple-300">Écologique</span>
                </div>

                <!-- Modèle 3: m-4.5 Pro -->
                <div class="model-card bg-gray-800/70 p-5 rounded-xl shadow-lg border border-gray-700/50 hover:border-pink-500 transition duration-300 transform hover:translate-y-[-4px]">
                    <h3 class="text-lg font-semibold mb-2 flex items-center text-white">
                        <span class="w-6 h-6 mr-2 bg-pink-500 rounded-full flex-shrink-0"></span><!-- Icône de remplacement -->
                        m-4.5 Pro
                    </h3>
                    <p class="text-gray-400 text-sm line-clamp-3">
                        Professionnel, précis.
                    </p>
                    <span class="mt-3 inline-block text-xs font-mono px-2 py-0.5 rounded-full bg-pink-900 text-pink-300">Professionnel</span>
                </div>
                
                <!-- Modèle 4: m-4.7o -->
                <div class="model-card bg-gray-800/70 p-5 rounded-xl shadow-lg border border-gray-700/50 hover:border-green-500 transition duration-300 transform hover:translate-y-[-4px]">
                    <h3 class="text-lg font-semibold mb-2 flex items-center text-white">
                        <span class="w-6 h-6 mr-2 bg-green-500 rounded-full flex-shrink-0"></span><!-- Icône de remplacement -->
                        m-4.7o
                    </h3>
                    <p class="text-gray-400 text-sm line-clamp-3">
                        Précis, long.
                    </p>
                    <span class="mt-3 inline-block text-xs font-mono px-2 py-0.5 rounded-full bg-green-900 text-green-300">Précis</span>
                </div>
                
                <!-- Modèle 5: m-4.9+ -->
                <div class="model-card bg-gray-800/70 p-5 rounded-xl shadow-lg border border-gray-700/50 hover:border-yellow-500 transition duration-300 transform hover:translate-y-[-4px]">
                    <h3 class="text-lg font-semibold mb-2 flex items-center text-white">
                        <span class="w-6 h-6 mr-2 bg-yellow-500 rounded-full flex-shrink-0"></span><!-- Icône de remplacement -->
                        m-4.9+
                    </h3>
                    <p class="text-gray-400 text-sm line-clamp-3">
                        Rapide, court.
                    </p>
                    <span class="mt-3 inline-block text-xs font-mono px-2 py-0.5 rounded-full bg-yellow-900 text-yellow-300">Rapide</span>
                </div>

            </div>
            
            <p class="text-center mt-12 text-gray-500 text-sm">
                Chacun de nos modèles est entraîné pour une performance optimale dans son domaine de spécialisation.
            </p>
        </section>

        <!-- SECTION 4: EXPLORATEUR DE CAPACITÉS (Gemini LLM Feature 1) -->
        <section id="explorateur" class="py-16 md:py-24">
            <!-- EMOJI RETIRÉ ICI -->
            <h2 class="text-4xl font-bold text-center mb-12 text-pink-400">Explorez les Capacités</h2> 
            <p class="text-center text-gray-400 max-w-2xl mx-auto mb-10">
                Découvrez quel modèle mAI est le mieux adapté à votre besoin spécifique. Entrez une tâche et laissez notre système recommander le modèle idéal.
            </p>

            <div class="bg-gray-800 rounded-xl p-6 md:p-8 shadow-2xl border border-pink-700/50 max-w-3xl mx-auto">
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <!-- SÉLECTION DU MODÈLE (pour l'affichage, non utilisé par l'IA) -->
                    <div class="md:col-span-1">
                        <label for="modelSelect" class="block text-sm font-medium text-gray-300 mb-2">Modèle de Référence :</label>
                        <select id="modelSelect" class="w-full p-2.5 rounded-lg bg-gray-900 border border-gray-700 text-white focus:ring-pink-500 focus:border-pink-500">
                            <option value="m-4.0">m-4.0 (Quotidien)</option>
                            <option value="m-4.3-mini">m-4.3-mini (Écologique)</option>
                            <option value="m-4.5 Pro" selected>m-4.5 Pro (Professionnel)</option>
                            <option value="m-4.7o">m-4.7o (Précis)</option>
                            <option value="m-4.9+">m-4.9+ (Rapide)</option>
                        </select>
                    </div>

                    <!-- TÂCHE UTILISATEUR -->
                    <div class="md:col-span-2">
                        <label for="taskInput" class="block text-sm font-medium text-gray-300 mb-2">Votre Tâche :</label>
                        <input type="text" id="taskInput" placeholder="Ex: Rédiger un email de lancement de produit détaillé." 
                               class="w-full p-2.5 rounded-lg bg-gray-900 border border-gray-700 text-white placeholder-gray-500 focus:ring-pink-500 focus:border-pink-500">
                    </div>
                </div>

                <!-- BOUTON D'ACTIVATION -->
                <div class="flex justify-center">
                    <button id="exploreButton" 
                            class="flex items-center justify-center px-6 py-2.5 bg-pink-600 text-white font-semibold rounded-full shadow-lg hover:bg-pink-700 transition duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                        <!-- EMOJI RETIRÉ ICI -->
                        <span id="buttonText">Recommander le Modèle</span> 
                        <div id="loadingIndicator" class="hidden loading-spinner w-5 h-5 border-4 border-gray-300 border-t-transparent rounded-full ml-3"></div>
                    </button>
                </div>
                
                <!-- RÉSULTATS DE L'EXPLORATION -->
                <div id="resultsContainer" class="mt-8 pt-6 border-t border-gray-700 hidden">
                    <p class="text-lg font-semibold text-pink-300 mb-3">Recommandation mAI :</p>
                    <div id="modelRecommendation" class="bg-gray-900 p-4 rounded-lg text-gray-300 italic min-h-[4rem]">
                        <!-- Le contenu généré par l'IA sera inséré ici -->
                    </div>
                </div>
                
                <!-- Zone d'erreur (masquée par défaut) -->
                <div id="errorBox" class="mt-4 p-3 bg-red-900/50 border border-red-500 text-red-300 rounded-lg hidden" role="alert">
                    Une erreur s'est produite lors de la connexion à l'IA. Veuillez réessayer plus tard.
                </div>

            </div>
        </section>

        <!-- SECTION 5: TÉMOIGNAGES / CAS D'USAGE (Devient la Section 5) -->
        <section id="temoignages" class="py-16 md:py-24">
            <h2 class="text-4xl font-bold text-center mb-16 text-white">Le succès de nos utilisateurs</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                
                <!-- Témoignage 1: Marc D. -->
                <div class="bg-gray-800 p-8 rounded-xl shadow-2xl border-l-4 border-indigo-500">
                    <p class="text-xl italic text-gray-300">
                        "En tant que développeur, mAI (modèle **m-4.5 Pro**) a divisé par deux le temps que je passais à déboguer des erreurs complexes. Il est d'une aide inestimable pour accélérer mes livraisons."
                    </p>
                    <div class="mt-6 flex items-center">
                        <span class="w-12 h-12 rounded-full bg-indigo-600 flex items-center justify-center text-xl font-bold">MD</span>
                        <div class="ml-4">
                            <p class="font-semibold text-white">Marc D.</p>
                            <p class="text-sm text-indigo-300">Développeur Senior chez TechCorp</p>
                        </div>
                    </div>
                </div>

                <!-- Témoignage 2: Sophie L. -->
                <div class="bg-gray-800 p-8 rounded-xl shadow-2xl border-l-4 border-purple-500">
                    <p class="text-xl italic text-gray-300">
                        "Le modèle **m-4.7o** est une mine d'or pour le marketing. Les idées de contenu sont d'une qualité professionnelle bluffante et me permettent de rester toujours en avance sur la concurrence."
                    </p>
                    <div class="mt-6 flex items-center">
                        <span class="w-12 h-12 rounded-full bg-purple-600 flex items-center justify-center text-xl font-bold">SL</span>
                        <div class="ml-4">
                            <p class="font-semibold text-white">Sophie L.</p>
                            <p class="text-sm text-purple-300">Directrice Marketing chez Alpha Solutions</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- NOUVELLE SECTION : Générateur de Témoignages (Gemini LLM Feature 2) -->
            <div class="bg-gray-800 rounded-xl p-6 md:p-8 shadow-2xl border border-indigo-700/50 max-w-3xl mx-auto mt-20">
                <!-- EMOJI RETIRÉ ICI -->
                <h3 class="text-3xl font-bold text-center mb-8 text-indigo-400">Générateur de Témoignages Pro</h3> 
                <p class="text-center text-gray-400 max-w-xl mx-auto mb-6">
                    Transformez un simple commentaire en un témoignage client convaincant, adapté à la voix d'un professionnel.
                </p>

                <div class="space-y-4">
                    <div>
                        <label for="rawFeedbackInput" class="block text-sm font-medium text-gray-300 mb-2">Votre feedback brut :</label>
                        <textarea id="rawFeedbackInput" rows="3" placeholder="Ex: m-4.7o donne de bonnes idées pour mes campagnes de pub."
                                  class="w-full p-2.5 rounded-lg bg-gray-900 border border-gray-700 text-white placeholder-gray-500 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="personaSelect" class="block text-sm font-medium text-gray-300 mb-2">Choisissez la Persona :</label>
                            <select id="personaSelect" class="w-full p-2.5 rounded-lg bg-gray-900 border border-gray-700 text-white focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="Développeur Senior">Développeur Senior</option>
                                <option value="Directeur Marketing">Directeur Marketing</option>
                                <option value="PDG (CEO)">PDG (CEO)</option>
                                <option value="Analyste Financier">Analyste Financier</option>
                            </select>
                        </div>
                        
                        <div class="flex items-end">
                             <button id="generateTestimonialButton" 
                                        class="flex items-center justify-center w-full px-6 py-2.5 bg-indigo-600 text-white font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed">
                                    <!-- EMOJI RETIRÉ ICI -->
                                    <span id="genButtonText">Générer le Témoignage</span> 
                                    <div id="genLoadingIndicator" class="hidden loading-spinner w-5 h-5 border-4 border-gray-300 border-t-transparent rounded-full ml-3"></div>
                                </button>
                        </div>
                    </div>

                </div>

                <!-- RÉSULTATS DE LA GÉNÉRATION -->
                <div id="genResultsContainer" class="mt-8 pt-6 border-t border-gray-700 hidden">
                    <p class="text-lg font-semibold text-indigo-300 mb-3">Témoignage Professionnel :</p>
                    <div id="generatedTestimonial" class="bg-gray-900 p-4 rounded-lg text-gray-300 italic min-h-[4rem]">
                        <!-- Le témoignage généré par l'IA sera inséré ici -->
                    </div>
                </div>
                
                <!-- Zone d'erreur (masquée par défaut) -->
                <div id="genErrorBox" class="mt-4 p-3 bg-red-900/50 border border-red-500 text-red-300 rounded-lg hidden" role="alert">
                    Une erreur s'est produite lors de la génération du témoignage. Veuillez réessayer plus tard.
                </div>
            </div>
        </section>

    </main>

    <!-- Pied de page -->
    <footer class="bg-gray-800/80 border-t border-gray-700/50 mt-16">
        <div class="max-w-6xl mx-auto p-8 text-center">
            
            <!-- Information Copyright et contact générique -->
            <p class="text-sm text-gray-500 mb-2">
                &copy; 2025 mAI - Tous droits réservés.
            </p>
            <p class="text-sm text-gray-500">
                Pour toute information ou demande d'accès, veuillez nous contacter via le réseau professionnel.
            </p>
        </div>
    </footer>

    <!-- LOGIQUE JAVASCRIPT POUR LES CAPACITÉS (Propulsé par Gemini) -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Éléments pour la Recommandation de Modèle (Feature 1)
            const exploreButton = document.getElementById('exploreButton');
            const taskInput = document.getElementById('taskInput');
            const modelSelect = document.getElementById('modelSelect');
            const resultsContainer = document.getElementById('resultsContainer');
            const modelRecommendation = document.getElementById('modelRecommendation');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const buttonText = document.getElementById('buttonText');
            const errorBox = document.getElementById('errorBox');

            // Nouveaux éléments pour le Générateur de Témoignages (Feature 2)
            const rawFeedbackInput = document.getElementById('rawFeedbackInput');
            const personaSelect = document.getElementById('personaSelect');
            const generateTestimonialButton = document.getElementById('generateTestimonialButton');
            const genResultsContainer = document.getElementById('genResultsContainer');
            const generatedTestimonial = document.getElementById('generatedTestimonial');
            const genLoadingIndicator = document.getElementById('genLoadingIndicator');
            const genButtonText = document.getElementById('genButtonText');
            const genErrorBox = document.getElementById('genErrorBox');

            // --- Configuration et Fonctions API Gemini ---
            const API_KEY = ""; 
            const MODEL_NAME = 'gemini-2.5-flash-preview-05-20';
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${API_KEY}`;
            
            // Descriptions des modèles mAI utilisées pour guider l'IA (Feature 1)
            const modelDescriptions = {
                'm-4.0': 'Le modèle généraliste pour des tâches quotidiennes simples et rapides (Quotidien).',
                'm-4.3-mini': 'Le modèle le plus léger, écologique et rapide pour des requêtes courtes et efficaces (Écologique).',
                'm-4.5 Pro': 'Le modèle professionnel, expert en précision, analyse de données complexes et raisonnements logiques (Professionnel).',
                'm-4.7o': 'Le modèle polyvalent, précis et capable de gérer de longues conversations et du contenu créatif (Précis).',
                'm-4.9+': 'Le fleuron, le plus rapide et le plus performant pour un résultat optimal sur tout type de tâche courte (Rapide).',
            };

            // Fonction utilitaire pour l'attente avec délai
            const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            // Fonction pour l'appel API avec Backoff Exponentiel (réutilisée pour les deux features)
            async function fetchWithExponentialBackoff(payload, maxRetries = 5) {
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const response = await fetch(API_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (response.ok) {
                            return await response.json();
                        } else if (response.status === 429 && i < maxRetries - 1) {
                            // Trop de requêtes (Too Many Requests) - Rétry
                            const delay = Math.pow(2, i) * 1000 + Math.random() * 500;
                            await sleep(delay);
                        } else {
                            throw new Error(`API call failed with status: ${response.status}`);
                        }
                    } catch (error) {
                        if (i === maxRetries - 1) {
                            console.error("Gemini API request failed after all retries.", error);
                            throw error;
                        }
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 500;
                        await sleep(delay);
                    }
                }
            }
            
            // --- Logique de Recommandation de Modèle (Feature 1) ---
            exploreButton.addEventListener('click', async () => {
                const userTask = taskInput.value.trim();
                const selectedModel = modelSelect.value;
                const modelInfo = modelDescriptions[selectedModel];
                
                // Réinitialisation de l'état
                errorBox.classList.add('hidden');
                modelRecommendation.innerHTML = 'Analyse en cours...';
                resultsContainer.classList.remove('hidden');

                if (userTask.length < 5) {
                    modelRecommendation.innerHTML = 'Veuillez entrer une description de tâche plus détaillée (minimum 5 caractères).';
                    return;
                }

                // Affichage de l'état de chargement
                exploreButton.disabled = true;
                loadingIndicator.classList.remove('hidden');
                buttonText.textContent = 'Analyse...';

                try {
                    // Création de l'instruction système
                    const systemPrompt = `
                        Vous êtes un expert en produits d'IA pour mAI. 
                        Votre tâche est de justifier lequel des 5 modèles mAI est le meilleur choix pour la tâche demandée par l'utilisateur. 
                        Utilisez uniquement les descriptions de modèles fournies ci-dessous. 
                        Vous devez fournir un paragraphe concis, enthousiaste et professionnel, en mettant en évidence le modèle recommandé (par exemple, "m-4.5 Pro") en gras.
                        Basez votre réponse sur la tâche de l'utilisateur et les capacités des modèles.
                        Ne mentionnez pas que les modèles sont fictifs, que vous êtes une IA, ou que vous n'avez pas accès à des données externes. 
                        N'utilisez PAS d'outil de recherche.
                    `;

                    // Création de la requête utilisateur
                    const userQuery = `
                        Basé sur les descriptions suivantes, quel modèle mAI est le meilleur pour la tâche : "${userTask}"?
                        
                        Descriptions des Modèles mAI:
                        ${Object.entries(modelDescriptions).map(([name, desc]) => `- ${name}: ${desc}`).join('\n')}
                    `;

                    const payload = {
                        contents: [{ parts: [{ text: userQuery }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                    };

                    const result = await fetchWithExponentialBackoff(payload);
                    const generatedText = result?.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (generatedText) {
                        modelRecommendation.innerHTML = generatedText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    } else {
                        throw new Error("Réponse de l'IA vide ou inattendue.");
                    }

                } catch (error) {
                    console.error("Erreur dans la recommandation de modèle:", error);
                    errorBox.classList.remove('hidden');
                    modelRecommendation.innerHTML = 'Impossible de générer la recommandation pour le moment.';
                } finally {
                    // Masquage de l'état de chargement
                    exploreButton.disabled = false;
                    buttonText.textContent = 'Recommander le Modèle'; // Mise à jour du texte sans emoji
                    loadingIndicator.classList.add('hidden');
                }
            });

            // --- Logique de Génération de Témoignage (Feature 2) ---
            generateTestimonialButton.addEventListener('click', async () => {
                const rawFeedback = rawFeedbackInput.value.trim();
                const persona = personaSelect.value;
                
                // Reset state
                genErrorBox.classList.add('hidden');
                generatedTestimonial.innerHTML = 'Génération en cours...';
                genResultsContainer.classList.remove('hidden');

                if (rawFeedback.length < 10) {
                    generatedTestimonial.innerHTML = 'Veuillez entrer un feedback plus substantiel (minimum 10 caractères).';
                    return;
                }

                // Show loading state
                generateTestimonialButton.disabled = true;
                genLoadingIndicator.classList.remove('hidden');
                genButtonText.textContent = 'Génération...';

                try {
                    const systemPrompt = `
                        Vous êtes un rédacteur de contenu professionnel spécialisé en témoignages clients pour des produits d'IA B2B. 
                        Transformez le feedback brut de l'utilisateur en un témoignage client convaincant. 
                        Le témoignage doit être au format d'une citation unique, crédible, enthousiaste, et refléter la perspective du rôle professionnel suivant: "${persona}". 
                        Le témoignage doit avoir entre 2 et 4 phrases, utiliser un langage professionnel, et se concentrer sur l'impact commercial ou technique (selon la persona). 
                        N'ajoutez pas le nom de la personne. Ne parlez pas en tant qu'IA.
                    `;

                    const userQuery = `Feedback brut à transformer : "${rawFeedback}"`;

                    const payload = {
                        contents: [{ parts: [{ text: userQuery }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                    };

                    const result = await fetchWithExponentialBackoff(payload);
                    const generatedText = result?.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (generatedText) {
                        // Ajout des guillemets français autour du témoignage
                        generatedTestimonial.innerHTML = `&ldquo;${generatedText.trim().replace(/^"|"$/g, '')}&rdquo;`;
                    } else {
                        throw new Error("Réponse de l'IA vide ou inattendue.");
                    }

                } catch (error) {
                    console.error("Erreur lors de la génération du témoignage:", error);
                    genErrorBox.classList.remove('hidden');
                    generatedTestimonial.innerHTML = 'Impossible de générer le témoignage pour le moment.';
                } finally {
                    // Hide loading state
                    generateTestimonialButton.disabled = false;
                    genLoadingIndicator.classList.add('hidden');
                    genButtonText.textContent = 'Générer le Témoignage'; // Mise à jour du texte sans emoji
                }
            });
        });
    </script>
</body>
</html>
